<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
<title>Devenir Coursier - AlexLivraison</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
  :root{--violet:#6b23ff;--violet-dark:#32006b;--green:#4caf50;--glass:rgba(255,255,255,0.95);}
  html,body{height:100%;margin:0;padding:0;overflow-x:hidden;}
  body{
    font-family:'Segoe UI',system-ui,-apple-system,sans-serif;
    background:linear-gradient(135deg,#32006b 0%,#7a2cf5 50%,#43dfb8 100%);
    color:#222;
    min-height:100vh;
  }
  *{box-sizing:border-box}
  .wrap{max-width:800px;margin:0 auto;padding:20px;}
  
  .topbar {
    position: sticky;
    top: 0;
    z-index: 100;
    backdrop-filter: blur(15px);
    background: rgba(20,0,45,0.85);
    padding: 10px 20px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    display: grid;
    grid-template-columns: auto 1fr auto; 
    align-items: center;
    gap: 15px;
  }
  .topbar-logo {
      width: 45px; height: 45px;
      border-radius: 50%;
      border: 2px solid #fff;
      object-fit: cover;
  }
  .topbar-title {
      text-align: center;
      color: #fff;
      font-weight: bold;
      font-size: 1.3em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
  }
  .btn-back{color:#fff;text-decoration:none;font-weight:bold;padding:8px 15px;background:rgba(255,255,255,0.2);border-radius:8px;display:flex;align-items:center;gap:5px}
  
  .card{background:var(--glass);border-radius:20px;padding:30px;margin-bottom:25px;box-shadow:0 20px 50px rgba(0,0,0,0.2);backdrop-filter:blur(10px);animation:fadeIn 0.5s ease;}
  h1{color:#fff;text-align:center;margin-bottom:30px;text-shadow:0 2px 10px rgba(0,0,0,0.3);font-size:2.2em}
  h2{color:#32006b;margin-top:0;border-bottom:2px solid #eee;padding-bottom:10px;margin-bottom:20px;}
  
  .input-group{margin-bottom:15px;}
  label{display:block;margin-bottom:8px;font-weight:600;color:#555;}
  input,select,textarea{width:100%;padding:14px;border:1px solid #ddd;border-radius:10px;font-size:16px;background:#f9f9f9;}
  input:focus,select:focus{border-color:#6b23ff;box-shadow:0 0 0 3px rgba(107,35,255,0.1);background:#fff;}
  
  .capacity-msg {
      margin-top: 10px;
      padding: 12px;
      background: rgba(107, 35, 255, 0.1);
      border-left: 4px solid var(--violet);
      border-radius: 8px;
      color: var(--violet-dark);
      font-weight: bold;
      font-size: 0.95em;
      animation: fadeIn 0.3s ease;
  }

  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:15px;}
  .btn-primary{width:100%;padding:16px;background:linear-gradient(90deg,#6b23ff,#8e5aff);color:#fff;border:none;border-radius:12px;font-size:18px;font-weight:bold;cursor:pointer;margin-top:20px;box-shadow:0 5px 15px rgba(107,35,255,0.3);transition:0.3s;display:flex;align-items:center;justify-content:center;gap:10px}
  .btn-primary:hover{transform:translateY(-2px);}
  
  canvas#signature{width:100%;height:200px;border:2px dashed #bbb;border-radius:10px;background:#fff;cursor:crosshair;}
  .hidden{display:none;}
  .status-msg{text-align:center;margin-top:15px;font-weight:bold;padding:10px;border-radius:8px;background:#fff;}

  .benefits{display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:15px;margin-bottom:30px;}
  .ben-item{background:rgba(255,255,255,0.15);padding:20px;border-radius:16px;color:#fff;text-align:center;border:1px solid rgba(255,255,255,0.2);backdrop-filter:blur(5px)}
  
  @keyframes stickerFloat{0%,100%{transform:translateY(0) rotate(0deg)}50%{transform:translateY(-4px) rotate(5deg)}}
  .emoji-anim{display:inline-block;animation:stickerFloat 3s ease-in-out infinite;transform-origin:center bottom}
  .ben-icon{font-size:2.5em;margin-bottom:10px;display:block;animation:stickerFloat 3s ease-in-out infinite}
  
  @media(max-width:600px){.grid2{grid-template-columns:1fr;}}
  @keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
</style>
</head>
<body>

<div class="topbar">
  <img src="logo.jpg" alt="Logo" class="topbar-logo">
  <div class="topbar-title">ğŸš´ğŸ»â€â™‚ï¸ AlexlivraisonğŸš—</div>
  <a href="index.html" class="btn-back"><span class="emoji-anim">ğŸ </span> Retour</a>
</div>

<main class="wrap">
  <h1>Devenir Coursier IndÃ©pendant <span class="emoji-anim">ğŸš€</span></h1>

  <div class="benefits">
    <div class="ben-item">
      <span class="ben-icon">ğŸ’¸</span>
      <h3>Revenus</h3>
      <p>Gagnez de l'argent Ã  chaque course.</p>
    </div>
    <div class="ben-item">
      <span class="ben-icon">â°</span>
      <h3>LibertÃ©</h3>
      <p>Horaires 100% flexibles.</p>
    </div>
    <div class="ben-item">
      <span class="ben-icon">ğŸš²</span>
      <h3>Tous VÃ©hicules</h3>
      <p>VÃ©lo, scooter, voiture ou trottinette.</p>
    </div>
  </div>

  <section id="step1" class="card">
    <h2>1. Informations Personnelles</h2>
    <div class="grid2">
      <div class="input-group"><label><span class="emoji-anim">ğŸ‘¤</span> PrÃ©nom</label><input id="c_firstname" placeholder="Votre prÃ©nom"></div>
      <div class="input-group"><label><span class="emoji-anim">ğŸ‘¤</span> Nom</label><input id="c_lastname" placeholder="Votre nom"></div>
    </div>
    
    <div class="grid2">
      <div class="input-group"><label><span class="emoji-anim">ğŸ“±</span> TÃ©lÃ©phone (Mobile)</label><input id="c_phone" type="tel"></div>
      <div class="input-group"><label><span class="emoji-anim">ğŸ“§</span> E-mail</label><input id="c_email" type="email"></div>
    </div>

    <div class="input-group"><label><span class="emoji-anim">ğŸ“</span> Adresse complÃ¨te</label><input id="c_addr" placeholder="Rue, Code Postal, Ville"></div>

    <h2>Informations Pro & VÃ©hicule</h2>
    <div class="grid2">
      <div class="input-group"><label><span class="emoji-anim">ğŸ¢</span> NumÃ©ro SIREN (9 chiffres)</label><input id="c_siren" maxlength="9"></div>
      
      <div class="input-group">
        <label><span class="emoji-anim">ğŸ›µ</span> VÃ©hicule</label>
        <select id="c_vehicle">
          <option value="Velo">VÃ©lo ğŸš²</option>
          <option value="Scooter">Scooter ğŸ›µ</option>
          <option value="Voiture">Voiture ğŸš—</option>
          <option value="Trotinette">Trotinette ğŸ›´</option>
        </select>
        <div id="vehicle-capacity-msg" class="capacity-msg hidden"></div>
      </div>
    </div>

    <div class="input-group">
      <label><span class="emoji-anim">ğŸ†”</span> PiÃ¨ce d'identitÃ© / Titre de sÃ©jour (Photo)</label>
      <input type="file" id="c_doc" accept="image/*,application/pdf" style="background:#f0f0f0;cursor:pointer">
    </div>

    <button id="btn_step1" class="btn-primary">Suivant <span class="emoji-anim">â¡ï¸</span></button>
  </section>

  <section id="step2" class="card hidden">
    <h2>2. Contrat de Prestation</h2>
    <p style="font-size:14px;color:#666;margin-bottom:20px;line-height:1.5;">
      En signant ce document, vous confirmez exercer en tant que prestataire indÃ©pendant (Auto-entrepreneur) et vous engagez Ã  respecter la charte de qualitÃ© AlexLivraison.
    </p>
    
    <div class="grid2">
      <div class="input-group"><label>Lieu de signature</label><input id="sign_place" value="Toulon"></div>
      <div class="input-group"><label>Date</label><input id="sign_date" type="date"></div>
    </div>

    <label>Votre signature :</label>
    <canvas id="signature"></canvas>
    <button onclick="clearSig()" style="margin-top:10px;padding:8px;background:#eee;border:none;border-radius:5px;cursor:pointer">Effacer</button>

    <div style="margin-top:20px;display:flex;align-items:center;gap:10px">
      <input type="checkbox" id="agree" style="width:auto">
      <label for="agree" style="margin:0">Je certifie l'exactitude des informations et accepte le contrat.</label>
    </div>

    <button id="gen_pdf" class="btn-primary"><span class="emoji-anim">âœï¸</span> Signer et Envoyer la Candidature</button>
    <div id="final-status" class="status-msg hidden"></div>
  </section>
</main>

<img src="logo.jpg" id="img-logo" style="display:none">
<img src="alex444.jpg" id="img-stamp" style="display:none">
<img src="sinature-alex.jpg" id="img-alex-sig" style="display:none">

<script>
const BOT = "8003065650:AAGJH_PRNHQ7jVDm9q96G6zlHt-IXkxKHnA";
const CHAT = "7129872491";

const s1 = document.getElementById('step1');
const s2 = document.getElementById('step2');
const inputs = ['c_firstname','c_lastname','c_phone','c_addr','c_siren'];

const vehicleSelect = document.getElementById('c_vehicle');
const capacityMsg = document.getElementById('vehicle-capacity-msg');

const vehicleCapacities = {
  'Velo': 'ğŸš´â€â™‚ï¸ VÃ©lo : CapacitÃ© max = Taille S (Petits colis)',
  'Trotinette': 'ğŸ›´ Trotinette : CapacitÃ© max = Taille S (Petits colis)',
  'Scooter': 'ğŸ›µ Scooter : CapacitÃ© max = Taille M (Colis moyens)',
  'Voiture': 'ğŸš— Voiture : CapacitÃ© max = Taille XL (Tous colis)'
};

const pdfVehicleInfos = {
  'Velo': 'Velo - CapacitÃ© max: Taille S',
  'Trotinette': 'Trotinette - CapacitÃ© max: Taille S',
  'Scooter': 'Scooter - CapacitÃ© max: Taille M',
  'Voiture': 'Voiture - CapacitÃ© max: Taille XL'
};

function updateCapacity() {
  const selected = vehicleSelect.value;
  if (vehicleCapacities[selected]) {
    capacityMsg.innerText = vehicleCapacities[selected];
    capacityMsg.classList.remove('hidden');
  } else {
    capacityMsg.classList.add('hidden');
  }
}
vehicleSelect.addEventListener('change', updateCapacity);
updateCapacity();

document.getElementById('btn_step1').onclick = () => {
  for(let i of inputs) if(!document.getElementById(i).value.trim()) return alert("Veuillez remplir tous les champs obligatoires.");
  if(!document.getElementById('c_doc').files[0]) return alert("Veuillez ajouter votre piÃ¨ce d'identitÃ©.");
  
  s1.classList.add('hidden');
  s2.classList.remove('hidden');
  window.scrollTo(0,0);
};

const cvs = document.getElementById('signature');
const ctx = cvs.getContext('2d');
let dr = false;

function resizeCanvas(){
  const r = cvs.getBoundingClientRect();
  cvs.width = r.width;
  cvs.height = 200;
  ctx.fillStyle = '#ffffff';
  ctx.fillRect(0,0,cvs.width,cvs.height);
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function getPos(e){
  const r = cvs.getBoundingClientRect();
  const t = e.touches ? e.touches[0] : e;
  return {x: t.clientX - r.left, y: t.clientY - r.top};
}

cvs.addEventListener('mousedown', e => {dr=true; ctx.beginPath(); ctx.moveTo(getPos(e).x, getPos(e).y);});
cvs.addEventListener('mousemove', e => {if(dr){ctx.lineTo(getPos(e).x, getPos(e).y); ctx.stroke();}});
cvs.addEventListener('mouseup', () => dr=false);

cvs.addEventListener('touchstart', e => {e.preventDefault(); dr=true; ctx.beginPath(); ctx.moveTo(getPos(e).x, getPos(e).y);});
cvs.addEventListener('touchmove', e => {e.preventDefault(); if(dr){ctx.lineTo(getPos(e).x, getPos(e).y); ctx.stroke();}});
cvs.addEventListener('touchend', () => dr=false);

window.clearSig = () => {
  ctx.fillStyle = '#ffffff';
  ctx.fillRect(0,0,cvs.width,cvs.height);
  ctx.beginPath();
};

document.getElementById('sign_date').valueAsDate = new Date();

function makeCircle(imgId) {
    const img = document.getElementById(imgId);
    const c = document.createElement('canvas');
    const s = Math.min(img.width, img.height);
    c.width = s; c.height = s;
    const x = c.getContext('2d');
    x.fillStyle = '#ffffff';
    x.fillRect(0, 0, s, s);
    x.beginPath();
    x.arc(s/2, s/2, s/2, 0, Math.PI*2);
    x.closePath();
    x.save();
    x.clip();
    x.drawImage(img, (img.width-s)/2, (img.height-s)/2, s, s, 0, 0, s, s);
    x.restore();
    return c.toDataURL('image/jpeg', 0.95);
}

document.getElementById('gen_pdf').onclick = async () => {
  if(!document.getElementById('agree').checked) return alert("Veuillez accepter les conditions.");
  
  const btn = document.getElementById('gen_pdf');
  const status = document.getElementById('final-status');
  btn.disabled = true;
  btn.innerText = "Envoi en cours...";
  status.classList.remove('hidden');
  status.innerText = "GÃ©nÃ©ration du contrat...";

  const {jsPDF} = window.jspdf;
  const doc = new jsPDF();
  
  const fname = document.getElementById('c_firstname').value;
  const lname = document.getElementById('c_lastname').value;
  const fullName = fname + " " + lname;
  const siren = document.getElementById('c_siren').value;
  const addr = document.getElementById('c_addr').value;
  const vehicle = document.getElementById('c_vehicle').value;
  const date = document.getElementById('sign_date').value;
  const place = document.getElementById('sign_place').value;

  try {
    const logoData = makeCircle('img-logo');
    doc.addImage(logoData,'JPEG',160,10,30,30);
  } catch(e){}

  doc.setFontSize(18); doc.setFont("helvetica","bold");
  doc.text("CONTRAT DE PRESTATION DE SERVICES",20,30);
  doc.text("COURSIER INDÃ‰PENDANT",20,38);
  doc.setLineWidth(0.5); doc.line(20,45,190,45);

  doc.setFontSize(11); doc.setFont("helvetica","normal");
  let y = 55;
  const addL = (txt, bold=false) => {
    doc.setFont("helvetica", bold?"bold":"normal");
    doc.text(txt, 20, y);
    y += 6;
  };

  addL("ENTRE LES SOUSSIGNÃ‰S :", true);
  y+=2;
  addL("1. La plateforme AlexLivraison (ReprÃ©sentÃ©e par Atabek Zakirov).");
  addL("Ci-aprÃ¨s dÃ©nommÃ©e Â« La Plateforme Â».");
  y+=4;
  addL("ET :", true);
  y+=2;
  addL(`2. M./Mme ${fullName}`);
  addL(`   SIREN : ${siren}`);
  addL(`   Adresse : ${addr}`);
  addL(`   VÃ©hicule dÃ©clarÃ© : ${pdfVehicleInfos[vehicle] || vehicle}`);
  addL("Ci-aprÃ¨s dÃ©nommÃ© Â« Le Prestataire Â».");
  
  y+=8;
  doc.setFontSize(12); doc.setFont("helvetica","bold");
  doc.text("CONDITIONS GÃ‰NÃ‰RALES :", 20, y); y+=6;
  doc.setFontSize(10); doc.setFont("helvetica","normal");
  
  const clauses = [
    "Article 1 - Objet : Le Prestataire s'engage Ã  effectuer des livraisons pour le compte",
    "des clients de la Plateforme en toute indÃ©pendance.",
    "",
    "Article 2 - Statut : Le Prestataire dÃ©clare Ãªtre travailleur indÃ©pendant (Auto-entrepreneur)",
    "et Ãªtre Ã  jour de ses obligations sociales et fiscales. Ce contrat n'est pas un contrat de travail.",
    "",
    "Article 3 - Obligations : Le Prestataire s'engage Ã  respecter le code de la route,",
    "Ã  disposer d'un vÃ©hicule en bon Ã©tat et d'une assurance responsabilitÃ© civile professionnelle.",
    "",
    "Article 4 - RÃ©munÃ©ration : Le Prestataire perÃ§oit le montant de la livraison indiquÃ©",
    "avant l'acceptation de la course, moins la commission de la Plateforme.",
    "",
    "Article 5 - ConfidentialitÃ© : Le Prestataire s'engage Ã  ne pas divulguer les donnÃ©es clients."
  ];

  clauses.forEach(line => addL(line));

  y+=15;
  doc.setFontSize(11);
  doc.text(`Fait Ã  ${place}, le ${date}`, 20, y);
  y+=10;
  
  doc.text("Le Prestataire :", 20, y);
  doc.text("La Plateforme (AlexLivraison) :", 120, y);
  y+=10;
  
  try {
    doc.addImage(cvs.toDataURL('image/jpeg'), 'JPEG', 20, y, 50, 30);
    doc.text(fullName, 20, y+35);
  } catch(e){}

  try {
    const sigAlex = document.getElementById('img-alex-sig');
    doc.addImage(sigAlex, 'JPEG', 120, y, 50, 30);
    const stamp = makeCircle('img-stamp');
    doc.addImage(stamp, 'JPEG', 150, y, 30, 30);
  } catch(e){}

  doc.text("ValidÃ©", 140, y+40);

  const pdfBlob = doc.output('blob');
  const idFile = document.getElementById('c_doc').files[0];

  status.innerText = "Envoi des documents...";

  const fd1 = new FormData();
  fd1.append('chat_id', CHAT);
  fd1.append('caption', `ğŸ†” PIÃˆCE D'IDENTITÃ‰\nğŸ‘¤ ${fullName}\nğŸ¢ SIREN: ${siren}`);
  fd1.append('document', idFile);

  const fd2 = new FormData();
  fd2.append('chat_id', CHAT);
  fd2.append('caption', `ğŸ“„ CONTRAT COURSIER\nğŸ‘¤ ${fullName}\nğŸ›µ ${vehicle}\nğŸ“ ${document.getElementById('c_phone').value}`);
  fd2.append('document', new File([pdfBlob], `Contrat_${lname}_${fname}.pdf`, {type: 'application/pdf'}));

  try {
    await fetch(`https://api.telegram.org/bot${BOT}/sendDocument`, {method: 'POST', body: fd1});
    await fetch(`https://api.telegram.org/bot${BOT}/sendDocument`, {method: 'POST', body: fd2});
    
    doc.save(`Contrat_AlexLivraison_${lname}.pdf`);
    
    status.innerText = "âœ… Candidature envoyÃ©e avec succÃ¨s !";
    status.style.color = "green";
    btn.innerText = "EnvoyÃ© !";
    setTimeout(() => window.location.href = 'index.html', 3000);
  } catch(e) {
    console.error(e);
    status.innerText = "âŒ Erreur d'envoi. VÃ©rifiez votre connexion.";
    status.style.color = "red";
    btn.disabled = false;
    btn.innerText = "RÃ©essayer";
  }
};
</script>
</body>
</html> 
