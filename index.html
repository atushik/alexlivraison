<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>AlexLivraison</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin></script>
  <style>
    :root{--violet:#6b23ff;--violet-dark:#32006b;--green:#4caf50;--ring:#ffffff35}
    html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;color:#222;background:linear-gradient(180deg,#32006b,#7a2cf5);background-attachment:fixed}
    .wrap{max-width:1060px;margin:0 auto;padding:16px}
    .topbar{position:sticky;top:0;z-index:50;backdrop-filter:saturate(160%) blur(12px);background:linear-gradient(180deg,rgba(20,0,45,.86),rgba(20,0,45,.52));border-bottom:1px solid var(--ring)}
    .topbar-inner{display:flex;align-items:center;gap:14px;justify-content:space-between;padding:12px 16px}
    .brand{display:flex;align-items:center;gap:10px;color:#fff;font-weight:800}
    .brand img{width:140px;height:auto;display:block}
    .hamb{width:40px;height:40px;border-radius:10px;display:grid;place-items:center;background:#ffffff12;border:1px solid #ffffff33;cursor:pointer}
    .hamb span,.hamb::before,.hamb::after{content:"";display:block;width:22px;height:2px;background:#fff;border-radius:2px;transition:.2s}
    .hamb::before{transform:translateY(-6px)}
    .hamb::after{transform:translateY(6px)}
    .drawer{position:fixed;inset:0;z-index:60;pointer-events:none}
    .drawer .shade{position:absolute;inset:0;background:#0009;opacity:0;transition:.25s}
    .drawer .panel{position:absolute;left:-280px;top:0;bottom:0;width:280px;background:#14002b;color:#fff;box-shadow:8px 0 30px #0006;padding:18px 14px;display:flex;flex-direction:column;gap:14px;transition:.25s}
    .drawer.open{pointer-events:auto}
    .drawer.open .shade{opacity:1}
    .drawer.open .panel{left:0}
    .drawer a{color:#fff;text-decoration:none;padding:12px;border-radius:10px;background:#ffffff12;border:1px solid #ffffff22}
    .drawer .langs{margin-top:auto;display:flex;gap:8px}
    .drawer .langs button{flex:1;background:#ffffff14;border:1px solid #ffffff33;color:#fff;padding:10px;border-radius:10px;cursor:pointer}
    .hero{padding:28px 16px 8px;color:#fff}
    .h2{color:#fff;margin:0 0 12px 0;font-weight:900}
    .muted{color:#e5d9ff;opacity:.92}
    .section{padding:18px 0}
    .card{background:#fff;border-radius:14px;padding:18px;box-shadow:0 14px 40px rgba(0,0,0,.22)}
    label{display:block;margin-top:10px;font-weight:700}
    input,select{width:100%;padding:12px;margin-top:6px;border-radius:10px;border:1px solid #cfd0d8;outline:none}
    input:focus,select:focus{border-color:#9f8bff;box-shadow:0 0 0 3px #9f8bff33}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px}
    .service{border:1px solid #e5e7ef;border-radius:10px;padding:8px;font-size:14px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    button{width:100%;padding:14px;border:none;border-radius:12px;font-size:16px;margin-top:10px;cursor:pointer}
    #calc{background:#6b23ff;color:#fff}
    #payCard{background:#4caf50;color:#fff}
    #payCash{background:#ececf4}
    #result{display:none;background:#f7f7ff;border-radius:12px;border:1px dashed #b6b4d6;margin-top:10px;padding:12px}
    #map{display:none;height:320px;border-radius:12px;margin-top:12px}
    .svc-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
    .svc{background:#fff;border-radius:14px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.18)}
    .svc h4{margin:0 0 6px 0}
    .partners{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .partner{background:#fff;border-radius:12px;padding:18px;display:grid;place-items:center;height:90px;box-shadow:0 8px 26px rgba(0,0,0,.16)}
    .partner span{opacity:.65}
    .contact-links a{display:inline-flex;align-items:center;gap:8px;padding:10px 12px;border-radius:10px;border:1px solid #e4e4ef;margin-right:8px;text-decoration:none;color:#222;background:#fff}
    .qr-block{display:grid;place-items:center;padding:18px}
    .qr-block img{width:240px;height:240px;object-fit:contain;background:#fff;border-radius:16px;box-shadow:0 12px 34px rgba(0,0,0,.25);padding:12px}
    .year{color:#e5d9ff;text-align:center;margin:8px 0 0 0;font-weight:700}
    .footer{color:#e5d9ff;text-align:center;margin:8px 0 24px 0}
    @media (max-width:900px){.row{grid-template-columns:1fr}.svc-grid{grid-template-columns:1fr}.partners{grid-template-columns:repeat(2,1fr)}}
  </style>
</head>
<body>
  <div class="topbar">
    <div class="topbar-inner wrap">
      <div class="brand"><img src="logo.jpg" alt="AlexLivraison"/></div>
      <div class="hamb" id="btn-menu"><span></span></div>
    </div>
  </div>

  <div class="drawer" id="drawer">
    <div class="shade" id="shade"></div>
    <div class="panel">
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:6px"><img src="logo.jpg" alt="AlexLivraison" style="width:120px;height:auto"></div>
      <a href="#calc-section" data-i="nav_calc">Calcul & Commande</a>
      <a href="#services" data-i="nav_services">Services</a>
      <a href="#partners" data-i="nav_partners">Partenaires</a>
      <a href="#contact" data-i="nav_contact">Contact</a>
      <div class="langs"><button id="btn-fr">FR</button><button id="btn-en">EN</button></div>
    </div>
  </div>

  <header class="hero wrap">
    <h1 class="h2" data-i="hero_title">Livraison locale rapide √† Toulon & La Seyne</h1>
    <p class="muted" data-i="hero_sub">Repas, courses, colis et petits envois ‚Äî √† v√©lo, scooter ou v√©hicule l√©ger. Commande en 30&nbsp;secondes.</p>
  </header>

  <main class="wrap">
    <section id="services" class="section">
      <h2 class="h2" data-i="svc_title">Nos services</h2>
      <div class="svc-grid">
        <div class="svc"><h4>üö¥ Livraison express</h4><div class="muted" data-i="svc_1">Courses, repas, petits colis en ville. Id√©al pour les trajets courts.</div></div>
        <div class="svc"><h4>üßä Livraison sensible</h4><div class="muted" data-i="svc_2">Colis fragile, temp√©rature contr√¥l√©e, attente en magasin.</div></div>
        <div class="svc"><h4>üè™ Click & Collect</h4><div class="muted" data-i="svc_3">R√©cup√©ration en boutique et livraison jusqu‚Äô√† votre porte.</div></div>
        <div class="svc"><h4>üì¶ B2B pour commer√ßants</h4><div class="muted" data-i="svc_4">Courses quotidiennes, devis sur demande, facturation mensuelle.</div></div>
      </div>
    </section>

    <section id="calc-section" class="section">
      <h2 class="h2" data-i="calc_title">Calcul du prix et commande</h2>
      <div class="row">
        <div class="card">
          <label data-i="lbl_name">Nom du client (optionnel)</label><input id="clientName" placeholder="Jean Dupont"/>
          <label data-i="lbl_phone">Num√©ro de t√©l√©phone du client</label><input id="clientPhone" placeholder="+33 6 12 34 56 78" required/>
          <label data-i="lbl_from">Adresse de d√©part</label><input id="from" placeholder="2 Rue Beaussier, Toulon"/>
          <label data-i="lbl_to">Adresse de destination</label><input id="to" placeholder="241 Rue Le Corbusier, La Seyne-sur-Mer"/>
          <div class="grid">
            <div><label data-i="lbl_size">Taille du colis</label>
              <select id="size">
                <option value="S">Petit (S)</option>
                <option value="M" selected>Moyen (M)</option>
                <option value="L">Grand (L)</option>
                <option value="XL">Tr√®s grand (XL)</option>
              </select>
            </div>
            <div><label data-i="lbl_floor">√âtage</label>
              <select id="floor">
                <option value="0">RDC / 1er (0 ‚Ç¨)</option>
                <option value="2">2e‚Äì5e (+2 ‚Ç¨)</option>
                <option value="2.5">6e‚Äì10e (+2,5 ‚Ç¨)</option>
                <option value="3">11e‚Äì15e (+3 ‚Ç¨)</option>
              </select>
            </div>
          </div>
          <label data-i="lbl_add">Services additionnels</label>
          <div class="grid">
            <label class="service"><input type="checkbox" class="srv" data-fee="2"/> Colis fragile (+2 ‚Ç¨)</label>
            <label class="service"><input type="checkbox" class="srv" data-fee="3"/> Livraison urgente (+3 ‚Ç¨)</label>
            <label class="service"><input type="checkbox" class="srv" data-fee="1"/> Attente 5 min (+1 ‚Ç¨)</label>
            <label class="service"><input type="checkbox" class="srv" data-fee="2"/> Attente 10 min (+2 ‚Ç¨)</label>
          </div>
          <label data-i="lbl_time">Heure de livraison souhait√©e</label><select id="time"></select>
          <label data-i="lbl_total">Montant total (‚Ç¨)</label><input id="total" readonly/>
          <button id="calc">üßÆ <span data-i="btn_calc">Calculer le prix</span></button>
          <button id="payCard">üí≥ <span data-i="btn_card">Paiement par carte</span></button>
          <button id="payCash">üí∂ <span data-i="btn_cash">Paiement en esp√®ces</span></button>
          <div id="result"></div>
          <div id="map"></div>
        </div>

        <div class="card">
          <h3 style="margin-top:0" data-i="pay_title">Paiement en ligne s√©curis√©</h3>
          <p class="muted" data-i="pay_sub">Le paiement par carte se fait via Stripe. Vous recevez un lien de paiement, et nous sommes notifi√©s instantan√©ment.</p>
          <ul class="muted" style="padding-left:18px;margin:0 0 6px 0">
            <li data-i="pay_ul_1">CB / Visa / Mastercard</li>
            <li data-i="pay_ul_2">Lien valable 30 minutes</li>
            <li data-i="pay_ul_3">Re√ßu envoy√© par e-mail</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="partners" class="section">
      <h2 class="h2" data-i="partners_title">Partenaires (exemples)</h2>
      <div class="partners">
        <div class="partner"><span>üõí Supermarch√©s</span></div>
        <div class="partner"><span>ü•ñ Boulangeries</span></div>
        <div class="partner"><span>üíä Pharmacies</span></div>
        <div class="partner"><span>üç± Restaurants</span></div>
        <div class="partner"><span>üßÄ √âpiceries fines</span></div>
        <div class="partner"><span>üì¶ Commer√ßants locaux</span></div>
      </div>
    </section>

    <section id="contact" class="section">
      <h2 class="h2">Contact</h2>
      <div class="card">
        <div class="muted" style="margin-bottom:10px">
          AlexLivraison ‚Äî La Seyne-sur-Mer / Toulon<br/>
          üìû 06 77 17 11 88 ¬∑ üìß atushbek020185@gmail.com
        </div>
        <div class="contact-links">
          <a href="https://wa.me/33677171188" target="_blank" rel="noopener">üí¨ WhatsApp</a>
          <a href="tel:+33677171188">üì≤ Appeler</a>
          <a href="mailto:atushbek020185@gmail.com">‚úâÔ∏è E-mail</a>
        </div>
      </div>
    </section>

    <div class="qr-block">
      <img src="qr.png" alt="QR AlexLivraison">
      <div style="margin-top:6px;color:#fff;font-weight:700">alexlivraison.shop</div>
    </div>

    <div class="year">2025</div>
    <div class="footer">¬© AlexLivraison</div>
  </main>

  <script>
    const drawer=document.getElementById('drawer');const shade=document.getElementById('shade');const btnMenu=document.getElementById('btn-menu');
    function toggleDrawer(open){drawer.classList[open?'add':'remove']('open')}
    btnMenu.onclick=()=>toggleDrawer(true);shade.onclick=()=>toggleDrawer(false);

    const I18N={
      fr:{nav_calc:"Calcul & Commande",nav_services:"Services",nav_partners:"Partenaires",nav_contact:"Contact",hero_title:"Livraison locale rapide √† Toulon & La Seyne",hero_sub:"Repas, courses, colis et petits envois ‚Äî √† v√©lo, scooter ou v√©hicule l√©ger. Commande en 30 secondes.",svc_title:"Nos services",svc_1:"Courses, repas, petits colis en ville. Id√©al pour les trajets courts.",svc_2:"Colis fragile, temp√©rature contr√¥l√©e, attente en magasin.",svc_3:"R√©cup√©ration en boutique et livraison jusqu‚Äô√† votre porte.",svc_4:"Courses quotidiennes, devis sur demande, facturation mensuelle.",calc_title:"Calcul du prix et commande",lbl_name:"Nom du client (optionnel)",lbl_phone:"Num√©ro de t√©l√©phone du client",lbl_from:"Adresse de d√©part",lbl_to:"Adresse de destination",lbl_size:"Taille du colis",lbl_floor:"√âtage",lbl_add:"Services additionnels",lbl_time:"Heure de livraison souhait√©e",lbl_total:"Montant total (‚Ç¨)",btn_calc:"Calculer le prix",btn_card:"Paiement par carte",btn_cash:"Paiement en esp√®ces",pay_title:"Paiement en ligne s√©curis√©",pay_sub:"Le paiement par carte se fait via Stripe. Vous recevez un lien de paiement, et nous sommes notifi√©s instantan√©ment.",pay_ul_1:"CB / Visa / Mastercard",pay_ul_2:"Lien valable 30 minutes",pay_ul_3:"Re√ßu envoy√© par e-mail",partners_title:"Partenaires (exemples)"},
      en:{nav_calc:"Quote & Order",nav_services:"Services",nav_partners:"Partners",nav_contact:"Contact",hero_title:"Fast local delivery in Toulon & La Seyne",hero_sub:"Meals, groceries, parcels & small items ‚Äî by bike, scooter or light vehicle. Order in 30 seconds.",svc_title:"Our services",svc_1:"Groceries, meals, small parcels in town. Perfect for short trips.",svc_2:"Fragile items, temperature-controlled, in-store waiting.",svc_3:"Click & Collect from stores delivered to your door.",svc_4:"Daily runs for shops, quotes on request, monthly invoicing.",calc_title:"Price calculator & order",lbl_name:"Client name (optional)",lbl_phone:"Client phone number",lbl_from:"Pickup address",lbl_to:"Dropoff address",lbl_size:"Parcel size",lbl_floor:"Floor",lbl_add:"Extra services",lbl_time:"Preferred delivery time",lbl_total:"Total amount (‚Ç¨)",btn_calc:"Calculate price",btn_card:"Pay by card",btn_cash:"Pay cash",pay_title:"Secure online payment",pay_sub:"Card payments are processed by Stripe. You get a payment link and we are notified instantly.",pay_ul_1:"CB / Visa / Mastercard",pay_ul_2:"Link valid for 30 minutes",pay_ul_3:"Receipt by e-mail",partners_title:"Partners (examples)"}
    };
    const tElems=[...document.querySelectorAll("[data-i]")];
    function setLang(lang){const d=I18N[lang]||I18N.fr;tElems.forEach(el=>{const k=el.dataset.i;if(d[k])el.textContent=d[k];});document.documentElement.lang=lang;}
    document.getElementById("btn-fr").onclick=()=>setLang("fr");
    document.getElementById("btn-en").onclick=()=>setLang("en");
    setLang("fr");

    const PRICE_PER_KM=0.9;
    const SIZE_FEES={S:0,M:0.5,L:1.0,XL:1.5};
    const TELEGRAM_BOT_TOKEN="8003065650:AAGJH_PRNHQ7jVDm9q96G6zlHt-IXkxKHnA";
    const TELEGRAM_CHAT_ID="7129872491";
    const MAPBOX_TOKEN="pk.eyJ1IjoiYWxleGxpdnJldXIiLCJhIjoiY21oZjRsODBxMDFpMTJrc2NuM3JyY2VrdyJ9.kErrSMRoIXzWqp9wnlayMg";
    const $=s=>document.querySelector(s);
    const res=$("#result");
    const mapDiv=$("#map");
    let lastCalc=null;
    function euro(v){return v.toFixed(2).replace(".", ",")+" ‚Ç¨";}
    const timeSel=$("#time");
    const now=new Date();
    for(let i=0;i<48;i++){const t=new Date(now.getTime()+i*30*60000);const label=t.toLocaleString(document.documentElement.lang==="en"?"en-GB":"fr-FR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"});const opt=document.createElement("option");opt.value=label;opt.textContent=label;timeSel.appendChild(opt);}

    async function geocode(q){const url=`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(q)}.json?limit=1&language=fr&access_token=${MAPBOX_TOKEN}`;const r=await fetch(url);const j=await r.json();if(!j.features.length)throw new Error("Adresse introuvable");const [lon,lat]=j.features[0].center;return{lat,lon};}
    async function route(lat1,lon1,lat2,lon2){const url=`https://api.mapbox.com/directions/v5/mapbox/driving/${lon1},${lat1};${lon2},${lat2}?geometries=geojson&overview=full&access_token=${MAPBOX_TOKEN}`;const r=await fetch(url);const j=await r.json();const path=j.routes[0];return{km:path.distance/1000,geo:path.geometry};}

    let map,routeLayer;
    function showMap(lat1,lon1,lat2,lon2,geo){if(!map){map=L.map("map");L.tileLayer(`https://api.mapbox.com/styles/v1/mapbox/streets-v12/tiles/{z}/{x}/{y}?access_token=${MAPBOX_TOKEN}`,{tileSize:512,zoomOffset:-1}).addTo(map);}if(routeLayer)routeLayer.remove();routeLayer=L.geoJSON(geo,{style:{color:"#6b23ff",weight:5}}).addTo(map);map.fitBounds([[lat1,lon1],[lat2,lon2]]);mapDiv.style.display="block";}

    async function sendToTelegram(text){const msg=encodeURIComponent(text);const url=`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage?chat_id=${TELEGRAM_CHAT_ID}&text=${msg}&parse_mode=Markdown`;await fetch(url);}

    async function calc(){
      const from=$("#from").value.trim();
      const to=$("#to").value.trim();
      const clientPhone=$("#clientPhone").value.trim();
      if(!from || !to || !clientPhone){alert("Veuillez remplir toutes les informations obligatoires.");return;}
      const size=$("#size").value;
      const floorFee=parseFloat($("#floor").value);
      let extras=0;document.querySelectorAll(".srv").forEach(x=>{if(x.checked)extras+=parseFloat(x.dataset.fee);});
      try{
        const [A,B]=await Promise.all([geocode(from),geocode(to)]);
        const r=await route(A.lat,A.lon,B.lat,B.lon);
        const dist=Math.round(r.km*100)/100;
        const price=Math.round(dist*PRICE_PER_KM+SIZE_FEES[size]+floorFee+extras);
        lastCalc={from,to,dist,price,size};
        res.style.display="block";
        res.innerHTML=`<b>Distance:</b> ${dist} km<br><b>Prix estim√©:</b> ${euro(price)}`;
        $("#total").value=price.toFixed(2);
        showMap(A.lat,A.lon,B.lat,B.lon,r.geo);
      }catch{alert("Erreur lors du calcul.");}
    }

    $("#calc").addEventListener("click",calc);

    $("#payCash").addEventListener("click",async()=>{
      if(!lastCalc)return alert("Calculez d'abord le prix.");
      const name=$("#clientName").value.trim()||"Non pr√©cis√©";
      const phone=$("#clientPhone").value.trim();
      const time=$("#time").value;
      alert("Commande enregistr√©e ‚úÖ Paiement en esp√®ces.");
      await sendToTelegram(`üÜï *Nouvelle commande (Esp√®ces)*
üë§ *Nom:* ${name}
üìû *T√©l√©phone:* ${phone}
üïí *Heure:* ${time}
üìç *De:* ${lastCalc.from}
üèÅ *√Ä:* ${lastCalc.to}
üì¶ *Distance:* ${lastCalc.dist} km
üí∂ *Prix:* ${lastCalc.price} ‚Ç¨`);
    });

    $("#payCard").addEventListener("click",async()=>{
      if(!lastCalc)return alert("Calculez d'abord le prix.");
      const name=$("#clientName").value.trim()||"Non pr√©cis√©";
      const phone=$("#clientPhone").value.trim();
      const time=$("#time").value;
      alert("Commande enregistr√©e ‚úÖ Paiement par carte.");
      await sendToTelegram(`üÜï *Nouvelle commande (Carte)*
üë§ *Nom:* ${name}
üìû *T√©l√©phone:* ${phone}
üïí *Heure:* ${time}
üìç *De:* ${lastCalc.from}
üèÅ *√Ä:* ${lastCalc.to}
üì¶ *Distance:* ${lastCalc.dist} km
üí≥ *Prix:* ${lastCalc.price} ‚Ç¨`);
      const response=await fetch("https://alexlivraison-api.onrender.com/api/pay",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:lastCalc.price,name,phone})});
      const data=await response.json();
      if(data.checkout_url)window.open(data.checkout_url,"_blank");else alert("Erreur de paiement.");
    });

    $("#from").value="2 Rue Beaussier, Toulon";
    $("#to").value="241 Rue Le Corbusier, La Seyne-sur-Mer";
  </script>
</body>
</html>
